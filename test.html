<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Page Title</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
  integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
  crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
  integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
  crossorigin=""></script>
  <style>
    #map {
      width: 500px;
      height: 500px;
    }
  </style>
</head>
<body>
  <div id="map"></div>
  <script>
    /*
    * This example shows how to add a layer list to a map where users can check and uncheck boxes to show and hide layers.
    * The code below is combined with the code to add geojson to a map, since those two things are often used together.
    * The code consists of five main parts:
    *    1. Create the basemap(s) and layer(s)
    *    2. Get geojson data and run a function to add it to a layer from step 1
    *    3. Create the function that will be run in step 2
    *    4. Create the list of layers that will appear in the control component
    *    5. Create the control component
    */

 var firstGeoJson={
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "properties": {
        "admin_level": 1
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              8.305878639221191,
              47.48033499841769
            ],
            [
              8.30742359161377,
              47.478710746833485
            ],
            [
              8.311071395874023,
              47.47995794448956
            ],
            [
              8.310105800628662,
              47.482220227468304
            ],
            [
              8.308131694793701,
              47.48220572596455
            ],
            [
              8.305878639221191,
              47.48033499841769
            ]
          ]
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "admin_level": 2
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              8.30765962600708,
              47.48079906107601
            ],
            [
              8.305299282073975,
              47.47791310490395
            ],
            [
              8.308753967285156,
              47.47485294807404
            ],
            [
              8.312294483184814,
              47.47705743919014
            ],
            [
              8.312294483184814,
              47.482147719909584
            ],
            [
              8.30765962600708,
              47.48079906107601
            ]
          ]
        ]
      }
    }
  ]
};

var adminLevels = [
  {name:"nothing", elements:undefined},
  {name:"Admin Level 1", elements:undefined},
  {name:"Admin Level 2", elements:undefined},
  {name:"Admin Level 3", elements:undefined},
];

    /* 1 */
    // create a basemap
    map = L.map('map').setView([0, 0], 1);
    let tiles = L.tileLayer( 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png' ).addTo( map );
    // create an operational layer that is empty for now
    let layerAdminL1 = L.layerGroup().addTo( map );
    let layerAdminL2 = L.layerGroup().addTo( map );
    let layerAdminL3 = L.layerGroup().addTo( map );

    /* 2 new */
    // fill that layer with data from a geojson file
    L.geoJSON(firstGeoJson, {
      onEachFeature: addMyData,
    })

    /* 3 */
    // This function is run for every feature found in the geojson file. It adds the feature to the empty layer we created above
    function addMyData( feature, layer ){
      // console.log(JSON.stringify(layer)); 
      // console.log(feature);
      //console.log(feature.properties.admin_level);
      var admin_level = feature.properties.admin_level;

      if (admin_level==1) {
        adminLevels[admin_level].elements = layerAdminL1.addLayer( layer );
      } else if (admin_level==2) {
        adminLevels[admin_level].elements = layerAdminL2.addLayer( layer );
      } else {
        adminLevels[admin_level].elements = layerAdminL3.addLayer( layer );
      }
      // some other code can go here, like adding a popup with layer.bindPopup("Hello")
    }

    /* 4 */
    // These options will appear in the control box that users click to show and hide layers
    let basemapControl = {
      "OSM Tiles": tiles, // an option to select a basemap (makes more sense if you have multiple basemaps)
    }

    var layerControl={};
    var key;
    var val;

    //Only show layer controls for layers with elements in them
    for (var i = 1; i < adminLevels.length; i++) {
      if (adminLevels[i].elements != undefined) {
        key = adminLevels[i].name;
        val = adminLevels[i].elements;
        layerControl[key] = val;
        //console.log(layerControl);
      }
    }
    console.log(layerControl);

    /* 5 */
    // Add the control component, a layer list with checkboxes for operational layers and radio buttons for basemaps
    L.control.layers( basemapControl, layerControl ).addTo( map )
  </script>
</body>
</html>